---
title: "Lab 04 - La Quinta is Spanish for next to Denny's, Pt. 1"
author: "George Nesbitt"
date: "02/03/2026"
output: github_document
---

### Load packages and data


```{r load-packages, message = FALSE}
library(tidyverse) 
library(dsbox) 
```

```{r load-data, message = FALSE}
states <- read_csv("data/states.csv")
```
```{r}
states <- read_csv("data/states.csv")
```


### Exercise 1
```{r glimpse dennys}
glimpse(dennys)
```
There are 1,643 rows in the Denny's dataset. These are each location. There are 6 columns in each data set. These are the variables address, city, state, zip code, longitutde and latitude.

### Exercise 2
```{r}
glimpse(laquinta)
```
There are 909 rows that represent the locations of each location. There are 6 columns which represent the variables address, city, state, zipcode, longitude and latitude

### Exercise 3
There are La Quinta locations in Canada, Mexico, China, New Zealand, Georgia (the country), Turkiye, UAE, Colombia and Ecuador.

There are Denny's locations in Canada, El Salvador, Indonesia, Phillipines, Chile, Guam, Japan, Costa Rica, Guatemala, Mexico, UAE, Curacao, Honduras, New Zealand and the UK.

### Exercise 4

I think potentially one way to figure out whether there are locations in different countries using only the data would be to filter data by longitude and latitude. If you could filter in any values for either that don't run through United States territory, you would know those Denny's are not American locations. 

### Exercise 5
```{r}
dennys %>%
  filter(!(state %in% states$abbreviation))
```
There are not any Denny's locations outside the US in this dataset

### Exercise 6

```{r}
dennys %>%
  mutate(country = "United States")
```

### Excercise 7
```{r}
laquinta %>%
  filter(!(state %in% states$abbreviation))
```
There are 14 La Quinta Locations in other countries. The countries are Peru (AG), Mexico ()

### Excercise 8
```{r}
laquinta <- laquinta %>% 
  mutate(country = case_when(
    state %in% state.abb ~ "United States",
    state %in% c("ON", "BC") ~ "Canada",
    state == "ANT" ~ "Colombia",
    state %in% c("AG","QR", "CH","NL","VE", "PU", "SL") ~ "Mexico",
    state == "FM" ~ "Honduras"
  ))
```
```{r}

```


```{r}
laquinta <- laquinta %>%
  filter(country == "United States")
```

### Excercise 9
```{r}
table(dennys$state)
```
Delaware Has the least amount of Denny's. This isn't super surprising because it is one of the smaller states. California has the most (double the next highest Texas)

```{r}
table(laquinta$state)
```
Maine, British Columbia, Ontario, Vermont, QR, SL AG and ANT (Not sure what Canadian state those are) have the least amount of La Quinta Locations and Texas has the most. The least are not surprising to me and the most is a little surprising because I thought that La Quinta was a California brand.


```{r}
dennys %>%
  count(state) %>%
  inner_join(states, by = c("state" = "abbreviation"))
```
```{r}
dennys%>%
  count(state) %>%
  inner_join(states, by = c("state" = "abbreviation"))
```
```{r}
dennys %>%
  count(state, name = "dennys_locations") %>% inner_join(states, by = c("state" = "abbreviation")) %>%
  mutate(dennys_per_1000_sq_miles = (dennys_locations / area) * 1000) %>%
  arrange(desc(dennys_per_1000_sq_miles))
```
```{r}
laquinta%>%
  count(state) %>%
  inner_join(states, by = c("state" = "abbreviation"))
```
```{r}
laquinta %>%
  count(state, name = "laquinta_locations") %>% inner_join(states, by = c("state" = "abbreviation")) %>%
  mutate(laquinta_per_1000_sq_miles = (laquinta_locations / area) * 1000) %>%
  arrange(desc(laquinta_per_1000_sq_miles))
```
## Excercise 10
From above, the most dennys per square mile is washington DC which makes sense due to the small area.
From above, the most La Quintas per square mile is Rhode Island which also makese sense due to the small area.


```{r}
dennys <- dennys %>% mutate(establishment = "Denny's")
laquinta <- laquinta %>% mutate(establishment = "La Quinta")
```
```{r}
dennys_laquinta <- bind_rows(dennys, laquinta)
```
```{r}
ggplot(dennys_laquinta, mapping = aes(x = longitude,y = latitude, color = establishment
)) + geom_point()
```
## Ex. 11
```{r}
ggplot(
  dennys_laquinta %>% filter(state == "NC"),
  aes( x = longitude,y = latitude, color = establishment
  )
) + geom_point(alpha=.5)

```

It doesn't appear that this joke is all that accurate here in North Carolina.
## Ex. 12
```{r}
ggplot(
  dennys_laquinta %>% filter(state == "TX"),
  aes( x = longitude,y = latitude, color = establishment
  )
) + geom_point(alpha=.3)

```


There are much more locations next to each other in Texas. Being from Texas I can also tell you that all the dots are big cities and the line from the center to the top middle is Interstate 35.


## Ex. 13
my chunks stopped loading here for some reason...